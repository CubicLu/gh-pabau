query GetContacts(
  $offset: Int
  $limit: Int
  $active: Int = 1
  $searchTerm: String
) {
  findManyCmContact(
    skip: $offset
    take: $limit
    where: {
      is_active: { equals: $active }
      AND: [
        {
          OR: [
            { Fname: { contains: $searchTerm } }
            { Lname: { contains: $searchTerm } }
            { Mobile: { contains: $searchTerm } }
            { Email: { contains: $searchTerm } }
          ]
        }
      ]
    }
  ) {
    Avatar
    ID
    Fname
    Lname
    Email
    Mobile
    DOB
    MailingCity
    MailingPostal
    is_active
    CmContactLabel {
       label_id
    }
  }
}

query GetContactsByLabel(
  $offset: Int
  $limit: Int
  $active: Int = 1
  $searchTerm: String
  $labelId: Int
) {
  findManyCmContact(
    skip: $offset
    take: $limit
    where: {
      is_active: { equals: $active }
      AND: [
        {
          OR: [
            { Fname: { contains: $searchTerm } }
            { Lname: { contains: $searchTerm } }
            { Mobile: { contains: $searchTerm } }
            { Email: { contains: $searchTerm } }
          ]
        }
      ]
      CmContactLabel: {
        some: {
          label_id: { equals: $labelId }
        }
      }
    }
  ) {
    Avatar
    ID
    Fname
    Lname
    Email
    Mobile
    DOB
    MailingCity
    MailingPostal
    is_active
    CmContactLabel {
       label_id
    }
  }
}

query clientListContactsCount($active: Int = 1, $searchTerm: String){
  findManyCmContactCount(where: {
    is_active: {
      equals: $active
    }
    AND: [
        {
          OR: [
            { Fname: { contains: $searchTerm } }
            { Lname: { contains: $searchTerm } }
            { Mobile: { contains: $searchTerm } }
            { Email: { contains: $searchTerm } }
          ]
        }
      ]
  })
}

query getContactsByLabelCount($active: Int = 1, $labelId: Int) {
  findManyCmContactCount(
    where: {
      is_active: { equals: $active }
      CmContactLabel: { some: { label_id: { equals: $labelId } } }
    }
  )
}

query getLabels($is_active: Int = 1) {
  findManyCmLabel(where: {
    CmContactLabel: {
      every: {
        CmContact: {
          is_active: {equals: $is_active}
        }
      }
    }
  }) {
    id
    name
    color
    company_id
    CmContactLabel {
      id
      CmContact {
        is_active
      }
    }
  }
}

mutation addLabel($name: String!, $color: String) {
  createOneCmLabel(data: {
    name: $name
    color: $color
    Company: {}
  }) {
    id
    name
    color
  }
}
